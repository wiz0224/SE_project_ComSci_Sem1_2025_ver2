(self.modernJsonp=self.modernJsonp||[]).push([["51723"],{95664:function(e,n,o){o.d(n,{$K:()=>i,dh:()=>a,ry:()=>t,xX:()=>s});let a=e=>/instagram/i.test(e||""),t=e=>a(e)||/facebook/i.test(e||"")||/line/i.test(e||"")||/wechat/i.test(e||""),l="[Pinterest/Android]",i=e=>(e||"").includes("[Pinterest/iOS]")||(e||"").includes(l),s=e=>(e||"").includes(l)},331357:function(e,n,o){o.d(n,{J:()=>l,U:()=>g});var a=o(27399),t=o(767415);let l="nic_v4",i=`${l}=1a`,s=`${l}=1b`,d=[i,s],r=["invite_code","invite","board_invite_code","sender"],u=null,_=e=>!!r.find(n=>e.includes(n)),p=e=>{let n;return e.pathname.includes("/pin/")&&!_(e.search)&&(n=e.search,!d.find(e=>n.includes(e)))},c=async e=>{let{resource_response:n}=await a.Z.create("InviteSocialTrackingParamNonInviteResource",{user_id:e}).callCreate();if(!n)return(0,t.nP)(`${l}.social_tracking_pin_non_invite.no_resource_response`),"";{let e=encodeURIComponent(n.data);return(0,t.nP)(`${l}.social_tracking_pin_non_invite.encrypted.${e?"true":"false"}`),e}},S=(e,n,o=!1,a)=>{if(!p(e))return;let d=o?"mweb":"web";if(!n)return void(0,t.nP)(`${d}.${l}.social_tracking_pin_non_invite.insert.no_encrypted_id`);(0,t.nP)(`${d}.${l}.social_tracking_pin_non_invite.insert.attempt`);try{let r=((e,n,o)=>{let a=e.search?"&":"?";return e.pathname+e.search+(a+(o?s:i)+n)})(e,n,o||!1);(0,t.nP)(`${d}.${l}.social_tracking_pin_non_invite.insert.success`),a(r)}catch{(0,t.nP)(`${d}.${l}.social_tracking_pin_non_invite.insert.caught_exception`)}},g=(e,n,o,a,i)=>{let s=o?"mweb":"web";(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.attempt`);try{let d;!o&&a&&p(e)?((0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.search_string_eligible`),((e,n,o=!1,a)=>{u?S(e,u,o,a):(async()=>{let t=await c(n);u=t,S(e,t,o,a)})()})(e,n,o,i)):(d=e.search,!_(d)&&!d.includes("sender")&&d.includes(l)&&(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.search_string_land`))}catch{(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.caught_exception`)}}},456871:function(e,n,o){o.d(n,{Z:()=>_});var a=o(312048),t=o(331357),l=o(173874),i=o(774838),s=o(843716),d=o(900907),r=o(986523),u=o(767415);function _(){let e,{isBot:n,isSocialBot:o,referrerFromCookie:_,referrerFromHeader:p,countryFromHostName:c,countryFromIp:S,regionFromIp:g,isAuthenticated:h}=(0,i.B)(),m=(0,a.TH)(),b=(0,r.Z)(),w=new URLSearchParams(m.search),y=!n&&!!w.get("utm_pai"),v=w.get("utm_source"),L=!n&&!o&&(0,l.ey)(m),O=(0,d.Z)({countryFromHostName:c||"",countryFromIp:S||"",regionFromIp:g||"",isAuthenticated:h}),I=p||O&&_||"";e=b||!O?I:(0,s.an)(I);let E=!1,C=!n&&!o&&v&&["email",String(31)].includes(v),N=!n&&!o&&v&&["fb"].includes(v),P="offsite"===v,U=!n&&!o&&!!(e&&(/facebook/.test(e)||/fb/.test(e))),M=!n&&!o&&!!(e&&(/twitter/.test(e)||/tw/.test(e)));L&&(0,u.nP)("unauth.entry_channel.invite_code",{sampleRate:1}),C&&(0,u.nP)("unauth.entry_channel.email_utm_source",{sampleRate:1}),N&&(0,u.nP)("unauth.entry_channel.social_media_utm_source_fb",{sampleRate:1}),P&&(0,u.nP)("unauth.entry_channel.offsite_utm_source",{sampleRate:1}),U&&(0,u.nP)("unauth.entry_channel.social_media_referer_fb",{sampleRate:1}),M&&(0,u.nP)("unauth.entry_channel.social_media_referer_twitter",{sampleRate:1}),E=(0,s.Xn)(e);let T=!n&&E,f=!!w.get(t.J),k=!!w.get("twa_type")||e&&e.startsWith("android-app://com.pinterest.twa"),R=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_admin","utm_id","utm_mail","utm_swu"].some(e=>null!==w.get(e))||!!e||f||k;return{isPaid:y,isInvite:L,utmSource:v,referrer:e,isSocial:L,isDirect:!n&&!y&&!L&&!T&&!R,isSEO:T,isBrowserStorageAllowed:O,isOffsite:P,isBot:n||o}}},843716:function(e,n,o){o.d(n,{Xn:()=>g,Yf:()=>w,an:()=>h});var a=o(173874),t=o(138482),l=o(575820);let i="BING",s="GOOGLE",d="YAHOO",r="YANDEX",u="RAKUTEN",_="NAVER",p="AMP_CACHE",c="DUCKDUCKGO",S=[s,i,d,r,u,_,p,c];function g(e){return S.includes(function(e){let{hostname:n}=(0,l.Qc)(e,!0);if(n&&e){if(n.includes("google.")||e.includes("android-app://com.google.android.googlequicksearchbox"))return s;else if(n.includes("bing."))return i;else if(n.includes("yahoo."))return d;else if(n.includes("yandex."))return r;else if(n.includes("rakuten."))return u;else if(n.includes("naver."))return _;else if(n.includes("duckduckgo."))return c;else if(n.includes(".cdn.ampproject.org"))return p}return""}(e))}function h(e){return e||"undefined"!=typeof document&&document.referrer||""}let m=e=>"/"!==e[e.length-1]?`${e}/`:e,b=e=>{let n=m(e),o=(0,a.ll)({url:n});return(0,a.L6)(o)?"PIN":(0,a.am)(o)?"BOARD":(0,t.Z)(o)?"PROFILE":(0,a.bo)(o)?"TODAY":(0,a.z_)(o)?"IDEA":(0,a.R$)(o)?"SHOPPING":"UNKNOWN"},w=({country:e,language:n,isBot:o,hostname:a,pathname:t})=>({domain:a,country:e,language:n,currentUrl:t,pageType:b(t),referrer:document.referrer,isBot:o,links:(({selector:e,skipExternal:n})=>{let o=Array.from(document.querySelectorAll(e)),a={pin:[],board:[],user:[],today:[],idea:[],shopping:[]},t=new Set;return o.forEach(e=>{let o=e.getAttribute("href");if(!o||o.startsWith("#")||n&&o.startsWith("http")&&!o.includes(window.location.hostname))return;let l=m(o);if(t.has(l))return;t.add(l);let i=b(l);"PIN"===i?a.pin.push(l):"BOARD"===i?a.board.push(l):"PROFILE"===i?a.user.push(l):"TODAY"===i?a.today.push(l):"IDEA"===i?a.idea.push(l):"SHOPPING"===i&&a.shopping.push(l)}),a})({selector:"a[href]",skipExternal:!0})})},434291:function(e,n,o){o.d(n,{m:()=>t,r:()=>l});var a=o(815271);function t(e,n){(0,a.Z)("ðŸŽ¯ ENGAGEMENT_SCORE_CALCULATED",{trigger:e,...n})}function l(e,n){(0,a.Z)("desktop"===e?"DESKTOP_UPSELL_DECISION":"MOBILE_UPSELL_DECISION",n)}},116412:function(e,n,o){o.d(n,{U:()=>t,a:()=>l});var a=o(935833);function t({PES:e,NUS:n,conversionIntentLevel:o,triggerAction:t,deviceType:l}){(0,a.My)("engagement_score.calculated",{engagement_score:e,upsell_negative_score:n,user_intent_bucket:o,upsell_type_tag:"conversion",trigger_action:t,device_type:l})}function l({upsellType:e,decision:n,intentLevel:o,PES:t,NUS:l,experimentVariant:i}){(0,a.My)("upsell.decision_with_intent",{upsell_type:e,decision:n,intent_level:o,pes:t,nus:l,experiment_variant:i})}},184285:function(e,n,o){o.d(n,{HZ:()=>m,ZP:()=>P,e_:()=>N,pT:()=>L});var a=o(667294),t=o(581722),l=o(15881),i=o(95664),s=o(79271),d=o(456871),r=o(774838),u=o(418282),_=o(270922),p=o(739405),c=o(658375),S=o(767415);let g=Date.now(),h=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal.modal.isShown??!1),m=()=>(0,t.v9)(e=>e.upsell?.modal),b=()=>(0,s.OC)(),w=()=>Date.now()-g,y=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal.isUnauthSharingModalsShown??!1),v=()=>(0,t.v9)(e=>!!e.upsell?.mWebSignupModal.modalHasShown),L=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal),O=()=>{let e=(0,r.B)(),n=(0,d.Z)(),o=(0,p.ZP)();return(0,a.useMemo)(()=>(0,_.T9)(e,n,o),[e,n,o])},I=Object.freeze(["CO","ID"]),E=e=>I.includes(e),C=e=>{if(!(0,i.ry)(e))return!1;let n=(0,u.Nl)();return n.getItem(l.QV)||((0,S.nP)("mobile_signup_modal.rules.suppress_for_social_in_app_browser"),n.setItem(l.QV,"1")),!0},N=({isModalShown:e,isUnauthSharingModalsShown:n,modalHasShown:o,country:a,userAgent:t})=>!e&&!(n||o&&E(a)||(0,c.P)()||C(t));function P(){let e=h(),n=(0,t.v9)(e=>e.upsell?.mWebSignupModal.modal),o=(0,t.v9)(e=>e.upsell?.mWebSignupModal.upsellEligibleNavigationCount),l=y();return{isModalShown:e,modal:n,upsellEligibleNavigationCount:o,isUnauthSharingModalsShown:l,modalHasShown:v(),sessionContext:O(),isUpsellEnabledGlobally:(()=>{let e=h(),n=y(),o=v(),t=O();return(0,a.useCallback)(()=>!e&&!(({isUnauthSharingModalsShown:e,modalHasShown:n,sessionContext:o})=>{if(!o)return!1;let{country:a,userAgent:t}=o;return e||n&&E(a)||(0,c.P)()||C(t)})({isUnauthSharingModalsShown:n,modalHasShown:o,sessionContext:t}),[e,n,o,t])})(),getPinImpressionCount:b,getSessionDuration:w}}},432414:function(e,n,o){o.d(n,{ZW:()=>w,Gk:()=>b,YM:()=>y});var a=o(173874),t=o(138482),l=o(434291),i=o(116412),s=o(730056);let d="dweb_eoq_q3_standard",r="dweb_eoq_q3_advanced",u="mweb_eoq_q3_standard",_="mweb_eoq_q3_advanced",p=[{bundleId:"dweb_eoq_q3_standard",experimentKey:d,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}}}},{bundleId:"dweb_eoq_q3_advanced",experimentKey:r,active:!0,overrides:{desktop_navigational_modal_trigger:{evaluateContextOverride:{direct:{navigationalPagesViewThresholdDesktop:0},paid:{navigationalPagesViewThresholdDesktop:0},seo:{navigationalPagesViewThresholdDesktop:2}},stateOverride:{modal:{displayProps:{isWashBlocking:!0,signupFlow:{type:"login"}}}}},desktop_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"}}}}},closeup_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}},stateOverride:{modal:{displayProps:{signupFlow:{type:"login"},container:"lopDownloadUpsell",source:"lopDownloadUpsell"}}}}}},{bundleId:"mweb_eoq_q3_standard",experimentKey:u,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}}}},{bundleId:"mweb_eoq_q3_advanced",experimentKey:_,active:!0,overrides:{mobile_on_land_upsell:{evaluateContextOverride:{direct:{shouldTriggerOnLand:!0},paid:{shouldTriggerOnLand:!0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_navigation_upsell:{evaluateContextOverride:{default:{navigationalPagesViewThresholdMobile:1}},stateOverride:{mWebSignupModal:{modal:{displayProps:{allowCloseOnOutsideClick:!1}}}}},mobile_main_pin_image_modal:{evaluateContextOverride:{default:{forceShowModal:!0}}},mobile_unauth_save_quota_check:{evaluateContextOverride:{default:{mobileUnauthSaveThreshold:0}},stateOverride:{mWebSignupModal:{modal:{displayProps:{headingType:"none"}}}}},mobile_context_menu_download_button_trigger:{evaluateContextOverride:{default:{limitReached:!0}}}}}];function c(e,n){let o=p.filter(o=>{if(!o.active||!o.overrides[e])return!1;switch(o.experimentKey){case d:return n("dweb_eoq_q3_standard").anyEnabled;case r:return n("dweb_eoq_q3_advanced").anyEnabled;case u:return n("mweb_eoq_q3_standard").anyEnabled;case _:return n("mweb_eoq_q3_advanced").anyEnabled;default:return!1}});return o[o.length-1]?.overrides[e]}let S=e=>({id:e.id,evaluate:function({ruleId:e,baseEvaluateFunction:n}){return o=>{let{checkExperiment:a,session:t}=o,l=a&&c(e,a)?.evaluateContextOverride||{},i=l[t?.channel??"default"]||l.default||{};return n((0,s.Z)(o,i))}}({ruleId:e.id,baseEvaluateFunction:e.evaluate}),getNextState:function({ruleId:e,baseNextStateFunction:n}){return({action:o,state:a,decision:t})=>{let l=n({action:o,state:a,decision:t});if(!("payload"in o&&"object"==typeof o.payload&&null!==o.payload&&"checkExperiment"in o.payload))return l;let i=c(e,o.payload.checkExperiment)?.stateOverride||{};return 0===Object.keys(i).length?l:(0,s.Z)(l,i)}}({ruleId:e.id,baseNextStateFunction:e.getNextState})});var g=o(671220);let h=(e,n)=>{let o={enabled_1:["high","medium"],enabled_2:["high"],enabled_3:["medium"],enabled_4:["medium","low"]}[n];return!!o&&o.includes(e||"unknown")},m=e=>{if(!e)return!1;let n=e("mweb_feature_upsell_copy_visual_combination_v2");if("enabled_copy_2"===n.group)return!0;if("control"===n.group)return!1;let o=e("mweb_feature_upsell_copy_visual_combination_v1");return["enabled_copy_1","enabled_copy_2","enabled_tone_filter_1","enabled_tone_filter_2","enabled_visual_search_1","enabled_visual_search_2","enabled_create_board_1","enabled_create_board_2"].some(e=>o.group===e)},b={shouldShowCloseupNavigationalModal:S({id:"closeup_navigational_modal_trigger",evaluate:({pinViewCount:e,navigationalPagesUpsellSeen:n,checkExperiment:o})=>!o?.("pc_no_navigational_upsell").anyEnabled&&(e??0)>=4&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_1",container:"closeup",reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowSaveModal:S({id:"save_modal_trigger",evaluate:()=>!0,getNextState:({action:e,state:n})=>({...n,pinSaveCount:n.pinSaveCount+1,pinId:e.payload.pinId,attributionLabel:e.payload.attributionLabel,showSaveModal:!0,modal:{isShown:!0,displayProps:{attributionLabel:e.payload.attributionLabel,container:"save",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",savePinId:e.payload.pinId,signupFlow:{type:"signup"},source:"saveButtonExp"}}})}),shouldShowNavigationalModal:S({id:"desktop_navigational_modal_trigger",evaluate:({uniqueNavigationalPagesSeen:e=[],navigationalPagesUpsellSeen:n,navigationalPagesViewThresholdDesktop:o,checkExperiment:a})=>!a?.("pc_no_navigational_upsell").anyEnabled&&e.length>=(o??4)&&!n,getNextState:({state:e,action:n})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_${n.payload.containerPage}`,container:n.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})}),shouldShowNavigationalModalIntentBased:S({id:"desktop_navigational_modal_intent_trigger",evaluate:({navigationalPagesUpsellSeen:e,engagementScore:n,checkExperiment:o})=>{let a=o?.("engagement_score_v0_dweb");if(!a?.anyEnabled||e)return!1;let{conversionIntentLevel:t,PES:s,NUS:d}=n||{},r=h(t,a.group);return(0,l.r)("desktop",{variant:a.group,decision:r?"SHOW":"SKIP",intentLevel:t,PES:s||0,NUS:d||0,reason:r?`Intent ${t} in allowed list`:`Intent ${t} NOT in allowed list`}),(0,i.a)({upsellType:"navigation_desktop",decision:r?"show":"skip",intentLevel:t||"unknown",PES:s||0,NUS:d||0,experimentVariant:a.group}),r},getNextState:({state:e,action:n})=>{let{conversionIntentLevel:o,PES:a,NUS:t}=e.engagementScore||{};return{...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_intent_${o}_pes_${a||0}_nus_${t||0}`,container:n.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0}}}),shouldShowSignupModalOnCloseUpClick:S({id:"closeup_modal_trigger",evaluate:({modal:e,clickCloseUp:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_closeup",container:"pinWash",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickCloseUp:!0})}),shouldShowSignupModalOnClickContextMenuSaveButton:S({id:"context_menu_save_button_trigger",evaluate:({modal:e,clickContextMenuSaveButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>{let o;return o=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:o},clickContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnClickCloseupSaveButton:S({id:"closeup_save_button_trigger",evaluate:({modal:e,clickCloseUpContextMenuSaveButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>{let o;return o=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:o},clickCloseUpContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnContextMenuDownloadClick:S({id:"desktop_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:n,modal:o})=>!!((e||n)&&!o?.isShown),getNextState:({action:e,state:n})=>{let o;return o=e.payload.inDwebSwapDownloadUpsellExp?{signupFlow:{type:"login"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"lopDownloadUpsell",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"lopDownloadUpsell"}:{signupFlow:{type:"signup"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:o},clickContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}}),shouldShowSignupModalOnCloseupDownloadClick:S({id:"closeup_download_button_trigger",evaluate:({limitReached:e,modal:n})=>!!(e&&!n?.isShown),getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId}},clickCloseUpContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource})}),shouldShowSignupModalOnFollowButtonClick:S({id:"follow_button_trigger",evaluate:({modal:e,clickFollowButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",container:e.payload.isContextualFollowEnabled?"follow":"",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:e.payload.isContextualFollowEnabled?"followButton":void 0}},clickFollowButton:!0})}),shouldShowSignupModalOnFollowingButtonClick:S({id:"following_button_trigger",evaluate:({modal:e,clickFollowingButton:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_following",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowingButton:!0})}),shouldShowSignupModalOnFollowersButtonClick:S({id:"followers_button_trigger",evaluate:({modal:e,clickFollowersButton:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_followers",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowersButton:!0})}),shouldShowLoginModalOnCommentComposerClick:S({id:"comment_composer_trigger",evaluate:({modal:e,clickCommentComposerUpsell:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"tap_unauth_comment_composer",container:"closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"commentComposer"}},clickCommentComposerUpsell:!0})}),shouldShowLoginModalOnRelatedPinOpenLinkClick:S({id:"related_pin_open_link_trigger",evaluate:({modal:e,clickRelatedPinOpenLinkUpsell:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"click_context_menu_related_pin_right_click_open_link_button",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickRelatedPinOpenLinkUpsell:!0})}),shouldShowLoginModalOnPinLinkClick:S({id:"pin_link_trigger",evaluate:({modal:e,pinLinkClickCount:n=0})=>!e?.isShown&&(2===n||n%5==0),getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"pinLinkClickHandler_tier1",container:"hybrid_clickthrough",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickPinLinkCount:e.payload.count})}),shouldShowSocialPinLandingModal:S({id:"social_pin_landing_modal_trigger",evaluate:({inviter:e,socialPinLandingModalShown:n,checkExperiment:o})=>!!e&&!n&&!!(o?.("ce_dweb_unauth_splp_blocking").anyEnabled||o?.("ce_dweb_unauth_splp_blocking_12s").anyEnabled),getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.type===g.Fy?`delay_${e.payload.containerPage}`:`scroll_${e.payload.containerPage}`,container:e.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},socialPinLandingModalShown:!0})}),shouldShowScrollingBox:{id:"desktop_scrolling_box_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},w={shouldShowSaveEducationPopover:S({id:"mobile_save_education_popover_trigger",evaluate:({saveEducationPopoverEverShown:e,checkExperiment:n})=>{if(e)return!1;let{group:o}=n?.("ce_mweb_unauth_social_feature_education")||{};return!!o?.startsWith("enabled_group_board")},getNextState:({state:e})=>({...e,showSaveEducationPopover:!0,saveEducationPopoverEverShown:!0})}),shouldShowReplyToSenderSheet:S({id:"mobile_reply_to_sender_sheet_trigger",evaluate:({replyToSenderSheetEverShown:e,checkExperiment:n})=>{if(e)return!1;let{group:o}=n?.("ce_mweb_unauth_social_feature_education")||{};return!!o?.startsWith("enabled_reply_to_sender")},getNextState:({state:e})=>({...e,showReplyToSenderSheet:!0,replyToSenderSheetEverShown:!0})}),shouldAllowUnauthSave:S({id:"mobile_unauth_save_quota_check",evaluate:({isPPMAndroidUnauthExperience:e,isFromUnauthContextMenu:n,currentUnauthSaves:o=0,mobileUnauthSaveThreshold:a})=>!n&&!e&&o<(a??2),getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:e.payload.headingType,trigger:{attributionLabel:"extended_save_out_of_quota"===e.payload.headingType?"click_save_button_with_max_unauth_saves":e.payload.attributionLabel||"click_save_button_on_closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageNavigationalModal:S({id:"mobile_main_pin_image_modal",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:n,isModalCurrentlyShown:o,learningUpsellScenario:a,forceShowModal:t})=>{let l=a&&n&&!o&&(e?.("mweb_unauth_main_learning_pin_full_page").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu_safe").anyEnabled);return a&&(t||!!l)},getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal?.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:"navigation_main_pin_image_click",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})}),shouldShowMainPinImageAppUpsell:{id:"mobile_main_pin_app_upsell_purple_banner",getNextState:({state:e})=>e,evaluate:({learningUpsellScenario:e,hasConversionUpsell:n,isLearningAppUpsellShown:o})=>n||!e?{shouldToggleAppUpsell:!1,currentlyShowing:!1,newState:!1}:{shouldToggleAppUpsell:!0,currentlyShowing:o,newState:!o}},shouldShowNavigationUpsell:S({id:"mobile_navigation_upsell",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:n,newLocation:o,isNavigationFromSwipe:a,currentNavigationCount:t,hasSeenModal:l,pageThreshold:i,isWashDismissible:s,canShowSignupModalOnRouteChange:d,navigationalPagesViewThresholdMobile:r,checkExperiment:u})=>{if(u?.("pc_no_navigational_upsell").anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};let _=r||i||4;return n?{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1}:e&&!a&&o&&d?.(o)?!((t??0)>=_)||l?{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0}:{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_${_}_${t}`,allowCloseOnOutsideClick:s,headingType:m(u)?"mweb_feature_upsell_copy_visual_combination_v1":"none"}:{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1}},getNextState:({state:e,decision:n})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:n?.headingType??"none",trigger:{attributionLabel:n?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!n?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowNavigationUpsellIntentBased:S({id:"mobile_navigation_upsell_intent",evaluate:({isUpsellEnabledGlobally:e,isModalCurrentlyShown:n,newLocation:o,isNavigationFromSwipe:a,hasSeenModal:t,canShowSignupModalOnRouteChange:s,engagementScore:d,checkExperiment:r})=>{let u=r?.("engagement_score_v0_mweb");if(!u?.anyEnabled)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(n)return{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1};if(!e||a||!o||!s?.(o))return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1};if(t)return{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0};let{conversionIntentLevel:_,PES:p,NUS:c}=d||{},S=h(_,u.group);return((0,l.r)("mobile",{variant:u.group,decision:S?"SHOW":"SKIP",intentLevel:_,PES:p||0,NUS:c||0,reason:S?`Intent ${_} in allowed list`:`Intent ${_} NOT in allowed list`}),(0,i.a)({upsellType:"navigation_mobile",decision:S?"show":"skip",intentLevel:_||"unknown",PES:p||0,NUS:c||0,experimentVariant:u.group}),S)?{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_intent_${_}_pes_${p||0}_nus_${c||0}`,allowCloseOnOutsideClick:!0,headingType:m(r)?"mweb_feature_upsell_copy_visual_combination_v1":"none"}:{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0}},getNextState:({state:e,decision:n})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:n?.headingType??"none",trigger:{attributionLabel:n?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!n?.allowCloseOnOutsideClick},pinId:null}}})}),shouldShowOnLandUpsell:S({id:"mobile_on_land_upsell",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:n,hasSeenNavUpsell:o,location:l,userAgent:i,showUnauthMwebSocialDefaultModalUpsell:s,isSocialInAppBrowser:d,shouldTriggerOnLand:r=!1})=>{let u;if(e?.("pc_no_navigational_upsell").anyEnabled||!n||o||!(l&&((0,a.L6)(l)||(0,a.am)(l)||(0,t.Z)(l)||(0,a.En)(l)||(0,a.ey)(l))))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let _=!(d?.(i)&&e?.("mweb_unauth_social_iab_upsell_boost_experiment",{dangerouslySkipActivation:!0}).anyEnabled)&&s;if(!s&&!r)return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let p=!_&&m(e);if("social"==(u=_?"social":p?"mweb_feature_upsell_copy_visual_combination_v1":"none")&&e){let n=e("ce_mweb_visual_plp_upsell");if(n.anyEnabled)switch(n.group){case"enabled_1":u="social_visual_1";break;case"enabled_2":u="social_visual_2";break;case"enabled_3":u="social_visual_3"}}return{shouldShowModal:!0,shouldIncrementCount:!0,showUnauthMwebSocialUpsell:_,modalConfig:{reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"navigation_0",navigationTriggeredUpsell:{newLocation:l,oldLocation:l},headingType:u}}},getNextState:({state:e,decision:n})=>{let{modalConfig:o}=n;return{...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:o?.headingType,trigger:{attributionLabel:o?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:null}}}}}),shouldShowSignupModalOnContextMenuDownloadClick:S({id:"mobile_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:n,modal:o})=>(e||n)&&!o?.isShown,getNextState:({action:e,state:n})=>{let{inMwebDownloadCTAExp:o,showDownloadCloseupIcon:a,attributionLabelSource:t}=e.payload,l={trigger:{attributionLabel:`click_${t}_download_button`,reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},headingType:o||a?"download_limit_reached":"none"};return{...n,mWebSignupModal:{...n.mWebSignupModal,modal:{isShown:!0,displayProps:l,pinId:e.payload.pinId??""}}}}}),shouldShowSignupModalOnFollowButtonClickMobile:S({id:"follow_button_trigger_mobile",evaluate:({mWebSignupModal:e})=>!e?.modal.isShown,getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:e.payload.isContextualFollowEnabled?"follow":"none",trigger:{attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0}}}})}),shouldShowFloatingBanner:{id:"mobile_floating_banner_trigger",evaluate:({checkExperiment:e})=>!e?.("pc_no_navigational_upsell").anyEnabled,getNextState:({state:e})=>e}},y={desktop:b,mobile:w}},671220:function(e,n,o){o.d(n,{dn:()=>x,UA:()=>V,ub:()=>ea,EH:()=>eu,Ik:()=>U,mV:()=>D,OU:()=>_,Gh:()=>g,LL:()=>eh,Li:()=>es,jB:()=>z,G5:()=>ec,CC:()=>eq,F8:()=>eL,Ue:()=>$,t:()=>eZ,h4:()=>H,g_:()=>Z,BF:()=>ed,rA:()=>M,aj:()=>eG,qD:()=>eU,IS:()=>eW,it:()=>k,Yr:()=>W,Vi:()=>F,by:()=>m,wK:()=>X,i8:()=>v,K7:()=>S,GY:()=>eE,vY:()=>ei,HK:()=>w,yC:()=>ex,f$:()=>Y,qs:()=>Q,Fy:()=>G,QG:()=>L,CH:()=>eA,WE:()=>ey,qT:()=>b,Dk:()=>el,Bh:()=>K,qq:()=>eH,Nx:()=>I,$S:()=>E,Lu:()=>ee,k7:()=>eM,Qm:()=>eD,Pp:()=>N,Sy:()=>eo,b9:()=>eS,z1:()=>en,$y:()=>u,tP:()=>O,Zr:()=>f,sg:()=>J,QC:()=>eP,Hm:()=>eg,FV:()=>eb,o9:()=>ef,MZ:()=>eV,V9:()=>q,AS:()=>c,kd:()=>T,pp:()=>p,QA:()=>ep,tW:()=>ev,v2:()=>eO,Jw:()=>e$,w$:()=>et,Pu:()=>eF,gU:()=>eQ,cD:()=>em,P9:()=>C,YT:()=>eB,pZ:()=>ek,dL:()=>e_,XE:()=>eN,Ff:()=>eT,tA:()=>B,TQ:()=>j,Q4:()=>y,gH:()=>R,aJ:()=>A,C5:()=>er,Aw:()=>eR,xY:()=>ew,Dw:()=>eK,Bi:()=>P,ap:()=>eI,ht:()=>eC,mX:()=>h});var a=o(95664),t=o(935833),l=o(184285),i=o(432414);let s=e=>{let{modal:n,mWebSignupModal:o,appUpsells:a}=e;return!!(n.isShown||o.modal.isShown||a.learningUpsell?.isShown||a.iabAppUpsell?.isShown)};var d=o(932921),r=o(767415);let u="PROCESS_MOBILE_NAVIGATION_CHANGE",_="SET_UPSELL_REASON",p="UPS_EVENT_PIN_VIEW",c="UPS_EVENT_PIN_SAVE",S="UPS_EVENT_DESKTOP_MODAL_SHOW",g="UPS_EVENT_DESKTOP_MODAL_DISMISSED",h="CLICK_CLOSE_UP_CONTEXT_MENU_SAVE_BUTTON",m="CLICK_CLOSE_UP_CONTEXT_MENU_DOWNLOAD_BUTTON",b="TRIGGER_SCROLL_DOWN_UPSELL",w="CLEAR_SCROLL_DOWN_UPSELL",y="DISMISS_BOTTOM_RIGHT_BANNER",v="TRIGGER_SAVE_EDUCATION_POPOVER",L="CLEAR_SAVE_EDUCATION_POPOVER",O="TRIGGER_REPLY_TO_SENDER_SHEET",I="CLEAR_REPLY_TO_SENDER_SHEET",E="CLICK_CLOSEUP_UPSELL",C="CLICK_CONTEXT_MENU_SAVE_BUTTON_UPSELL",N="CLICK_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",P="CLICK_FOLLOW_BUTTON_UPSELL",U="CLICK_FOLLOWING_BUTTON_UPSELL",M="CLICK_FOLLOWERS_BUTTON_UPSELL",T="CLICK_COMMENT_COMPOSER_UPSELL",f="CLICK_PIN_LINK_UPSELL",k="CLICK_RELATED_PIN_OPEN_LINK_UPSELL",R="RECORD_NAVIGATIONAL_PAGE",D="SET_INITIAL_SESSION_CONTEXT",x="RESET_UPSELL_TRIGGER_STATE",A="RECORD_SOCIAL_PIN_LANDING_PAGE",G="TRIGGER_SOCIAL_DELAY_MODAL",F="TRIGGER_SOCIAL_SCROLL_MODAL",W="SHOW_MOBILE_SIGNUP_MODAL",B="DISMISS_MOBILE_SIGNUP_MODAL",H="SET_MOBILE_SIGNUP_MODAL_TOP_INTEREST",$="INCREMENT_UPSELL_ELIGIBLE_NAVIGATION_COUNT",q="HIDE_UNAUTH_SHARING_MODALS",V="SHOW_UNAUTH_SHARING_MODALS",K="RESTORE_FROM_LOCAL_STORAGE",Z="MAIN_PIN_IMAGE_CLICK_MOBILE",Q="ON_LAND_UPSELL_MOBILE",Y="SET_LEARNING_UPSELL_VISIBILITY",X="CLICK_MOBILE_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",j="DISMISS_MOBILE_FLOATING_UPSELL",J="CLICK_FOLLOW_BUTTON_UPSELL_MOBILE",z="INCREMENT_PIN_SAVE_COUNT",ee="DECREMENT_PIN_SAVE_COUNT",en="INCREMENT_UNAUTH_CLICKTHROUGH_COUNT",eo="SET_UNAUTH_DOWNLOAD_COUNT",ea="UPS_EVENT_PIN_SAVE_MOBILE",et="SET_REFERRED_APP_UPSELL_STATE",el=e=>({type:K,payload:{upsellEligibleNavigationCount:e}}),ei=e=>({type:_,payload:{upsellReason:e}}),es=(e,n,o,a,t)=>({type:p,payload:{pinId:e,seoUrl:n,componentType:o,viewParameter:a,checkExperiment:t}}),ed=(e,n)=>({type:c,payload:{pinId:e,attributionLabel:n}}),er=()=>({type:g}),eu=()=>({type:y}),e_=e=>({type:S,payload:{displayProps:e}}),ep=()=>({type:E}),ec=(e,n,o)=>({type:C,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:o}}),eS=(e,n)=>({type:P,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}),eg=(e,n,o,a)=>({type:h,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:o,checkExperiment:a}}),eh=({pinId:e,attributionLabelSource:n,downloadAllowedCallback:o})=>({checkExperiment:a,sessionContext:l})=>(l,i)=>{let r=i(),{limitReached:u,oldCount:_,newCount:p}=(0,d.H)(a,{downloadCount:r.upsell?.unauthDownloadCount??0,upsellDispatch:l,isAuthenticated:r.session?.isAuthenticated??!1});(0,t.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:u,oldCount:_,newCount:p}),l({type:m,payload:{pinId:e,attributionLabelSource:n,limitReached:u,checkExperiment:a}}),s(i().upsell)||o()},em=({pinId:e,attributionLabelSource:n,inImmediateUpsellGroup:o,inDwebSwapDownloadUpsellExp:a,downloadAllowedCallback:l,showDownloadIconForRelatedPins:i,inDwebDownloadCTAExp:r})=>({checkExperiment:u,sessionContext:_})=>(_,p)=>{let c=p(),{limitReached:S,oldCount:g,newCount:h}=(0,d.H)(u,{downloadCount:c.upsell?.unauthDownloadCount??0,upsellDispatch:_,isAuthenticated:c.session?.isAuthenticated??!1});i?(0,t.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:n,limitReached:S,oldCount:g,newCount:h}):r?(0,t.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:n}):a?(0,t.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:n}):(0,t.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:S,oldCount:g,newCount:h}),_({type:N,payload:{pinId:e,attributionLabelSource:n,limitReached:S,inImmediateUpsellGroup:o,inDwebSwapDownloadUpsellExp:a,checkExperiment:u}}),s(p().upsell)||l()},eb=()=>({type:U}),ew=()=>({type:M}),ey=()=>({type:T}),ev=e=>({type:f,payload:{count:e}}),eL=()=>({type:k}),eO=(e,n)=>({checkExperiment:o,sessionContext:a})=>t=>{t({type:R,payload:{pageUniqueKey:e,containerPage:n,checkExperiment:o,sessionContext:a}})},eI=e=>({type:D,payload:{sessionContext:e}}),eE=(e,n)=>({type:A,payload:{inviter:e,containerPage:n}}),eC=e=>({checkExperiment:n})=>o=>{o({type:G,payload:{containerPage:e,checkExperiment:n}})},eN=e=>({checkExperiment:n})=>o=>{o({type:F,payload:{containerPage:e,checkExperiment:n}})},eP=()=>({type:L}),eU=()=>({checkExperiment:e,sessionContext:n})=>o=>{let{group:a}=e?.("ce_mweb_unauth_social_feature_education")||{};a?.startsWith("enabled_group_board")?o((({checkExperiment:e})=>n=>{n({type:v,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:n})):a?.startsWith("enabled_reply_to_sender")&&o((({checkExperiment:e})=>n=>{n({type:O,payload:{checkExperiment:e}})})({checkExperiment:e,sessionContext:n}))},eM=()=>({type:I}),eT=e=>({type:W,payload:e}),ef=()=>({type:B}),ek=e=>({type:H,payload:{topInterest:e}}),eR=()=>({type:$}),eD=()=>({type:q}),ex=()=>({type:V}),eA=e=>({checkExperiment:n,sessionContext:o})=>(a,l)=>{a({type:u,payload:{...e,checkExperiment:n,sessionContext:o}}),s(l().upsell)||(0,t.My)(`mweb.nav.upsell.show.${e.currentNavigationCount}`)},eG=e=>({checkExperiment:n,sessionContext:o})=>(s,d)=>{let u=d().upsell,{country:_,userAgent:p}=o,c=i.YM.mobile.shouldShowOnLandUpsell?.evaluate({checkExperiment:n,isUpsellEnabledGlobally:(0,l.e_)({isModalShown:u.mWebSignupModal.modal.isShown??!1,isUnauthSharingModalsShown:u.mWebSignupModal.isUnauthSharingModalsShown??!1,modalHasShown:!!u.mWebSignupModal.modalHasShown,country:_,userAgent:p}),hasSeenNavUpsell:u.mWebSignupModal.modalHasShown,location:e.location,isPaid:e.isPaid,isSocial:e.isSocial,isDirect:e.isDirect,isSEO:e.isSEO,userAgent:p,showUnauthMwebSocialDefaultModalUpsell:e.showUnauthMwebSocialDefaultModalUpsell,isSocialInAppBrowser:a.ry,session:o});c.shouldShowModal&&c.modalConfig&&((0,t.My)("mweb.nav.upsell.show.0"),c.showUnauthMwebSocialUpsell&&(0,r.nP)("unauth.mweb.social.pin.upsell",{sampleRate:1}),s({type:Q,payload:{decision:c,checkExperiment:n}}))},eF=e=>({checkExperiment:n,sessionContext:o})=>(a,l)=>{let s=l().upsell,d=!!s.appUpsells.learningUpsell?.isShown,r=i.YM.mobile.shouldShowMainPinImageNavigationalModal?.evaluate({checkExperiment:n,session:o,isUpsellEnabledGlobally:e.upsellContext.isUpsellEnabledGlobally(),isModalCurrentlyShown:e.upsellContext.isModalShown,learningUpsellScenario:e.learningUpsellScenario}),u=i.YM.mobile.shouldShowMainPinImageAppUpsell?.evaluate({learningUpsellScenario:e.learningUpsellScenario,hasConversionUpsell:!!r,isLearningAppUpsellShown:d});r?(0,t.My)("mweb.nav.upsell.show.main_pin_image_click"):u.shouldToggleAppUpsell?u.currentlyShowing?e.trackInteraction({action:"dismiss",item:"learning-upsell"}):e.trackInteraction({action:"click",item:"learning-upsell"}):e.onImageClick(),a({type:Z,payload:{conversionDecision:r,appUpsellDecision:u,checkExperiment:n,pinId:e.pinId}})},eW=({isShown:e,isDismissedByUser:n=!1})=>({type:Y,payload:{isShown:e,isDismissedByUser:n}}),eB=({pinId:e,attributionLabelSource:n,inImmediateUpsellGroup:o,inMwebDownloadCTAExp:a,showDownloadCloseupIcon:l,downloadAllowedCallback:i})=>({checkExperiment:r,sessionContext:u})=>(u,_)=>{let p=_(),{limitReached:c,oldCount:S,newCount:g}=(0,d.H)(r,{downloadCount:p.upsell?.unauthDownloadCount??0,upsellDispatch:u,isAuthenticated:p.session?.isAuthenticated??!1});a?(0,t.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:n}):l?(0,t.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:n}):(0,t.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:c,oldCount:S,newCount:g}),u({type:X,payload:{pinId:e,attributionLabelSource:n,limitReached:c,inImmediateUpsellGroup:o,inMwebDownloadCTAExp:a,showDownloadCloseupIcon:l,checkExperiment:r}}),s(_().upsell)||i()},eH=({isDismissedByUser:e=!1}={})=>({type:j,payload:{isDismissedByUser:e}}),e$=(e,n)=>({type:J,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}),eq=()=>({type:ee}),eV=()=>({type:en}),eK=e=>({type:eo,payload:{count:e}}),eZ=e=>({checkExperiment:n,sessionContext:o})=>(o,a)=>{let t=a().upsell;i.YM.mobile.shouldAllowUnauthSave?.evaluate({checkExperiment:n,isPPMAndroidUnauthExperience:e.isPPMAndroidUnauthExperience,isFromUnauthContextMenu:e.isFromUnauthContextMenu,currentUnauthSaves:e.unauthSavedPinsStore.pins.length})&&!t.mWebSignupModal.modal.isShown?(e.unauthSavedPinsStore.save({id:e.pinId,nodeId:e.nodeId,imageUrl:e.getPinGifOrImageSrc({imagesUrls:e.imagesUrls,embedSrc:e.embedSrc,embedType:e.embedType,excludeOriginals:!e.isBot&&!e.isSocialBot})}),o({type:z}),e.handleShowNavFooter(o,e.forceShowNavFooter,e.isNavBarHidden,e.setForceShowNavFooter),e.successCallback&&e.successCallback()):o({type:ea,payload:{attributionLabel:e.isFromUnauthContextMenu?e.attributionLabel||"click_save_button_on_closeup":"click_save_button_with_max_unauth_saves",headingType:e.isFromUnauthContextMenu?"save":"extended_save_out_of_quota",pinId:e.pinId,checkExperiment:n}})},eQ=({isShown:e,appUpsellType:n,isBlocking:o})=>({type:et,payload:{isShown:e,appUpsellType:n,isBlocking:o}})},270922:function(e,n,o){o.d(n,{A4:()=>d,T9:()=>r,qo:()=>s,y1:()=>i});var a=o(95664),t=o(969809),l=o(238957);let i=e=>e?(0,t.Z)(e.toUpperCase()):"OTHER",s=e=>e.isPaid?"paid":e.isInvite?"invite":e.isSocial?"social":e.isSEO?"seo":e.utmSource?`utm_${e.utmSource}`:"direct",d=e=>e&&"string"==typeof e?(0,a.$K)(e)?"pinterest":(0,a.dh)(e)?"instagram":/wechat|micromessenger/i.test(e)?"wechat":(0,a.ry)(e)||/facebook|fbav|fban|tiktok|twitter|line/i.test(e)?"social":"none":"none",r=(e,n,o)=>{let a=e?.countryFromHostName||e?.country||"",t=e?.userAgent?.raw||("undefined"!=typeof navigator?navigator.userAgent:""),r=(0,l.iU)();return{country:a,userAgent:t,referrer:e?.referrerFromHeader||e?.referrerFromCookie||"",unauthID:e?.unauthId||"",region:i(a),channel:s(n),iab:d(t),deviceType:o,revisitationState:r,revisitationCount:r.count,daysSinceLastVisit:(e=>{let{ts:n}=e;if(!n||0===n)return 0;let o=new Date,a=new Date(n);return Math.max(Math.floor(Number(((o.getTime()-a.getTime())/864e5).toFixed(2))),0)})(r)}}},932921:function(e,n,o){o.d(n,{H:()=>i,Z:()=>l});var a=o(935833),t=o(671220);async function l({filename:e,imgSrc:n,imageDownloadSuccessCallback:o,category:t,pinId:l,viewParameter:i,viewType:s,isUnauth:d=!1,platform:r="web",expName:u,expGroup:_},p){return"undefined"==typeof window?Promise.resolve():((0,a.My)("web.download.click",{category:t||"no_category",authType:d?"unauth":"auth",platform:r,viewType:s,expName:u,expGroup:_}),p({event_type:82,object_id_str:l,view_type:s||3,view_parameter:i||139}),n&&document)?fetch(n,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(e=>e.blob()).then(n=>{let l=document.createElement("a");l.href=window.URL.createObjectURL(n),e&&l.setAttribute("download",e.replace(".","_")),l.style.display="none",document.body?.appendChild(l),l.click(),document.body?.removeChild(l),(0,a.My)("web.download.success",{category:t||"no_category",authType:d?"unauth":"auth",platform:r,viewType:s,expName:u,expGroup:_}),o?.()}).catch(()=>{throw(0,a.My)("web.download.failure",{category:t||"no_category",authType:d?"unauth":"auth",platform:r,viewType:s,expName:u,expGroup:_}),Error("Download image error")}):Promise.resolve()}let i=(e,n)=>{let{downloadCount:o=0,upsellDispatch:a,isAuthenticated:l,updateDownloadCount:i}=n||{};if(l)return{limitReached:!1,oldCount:0,newCount:0};if(e("unuath_download_paywalled").anyEnabled||e("unauth_combined_download_exp").anyEnabled)return{limitReached:!0,oldCount:0,newCount:0};let s=o>=1,d=s?o:o+1;return o!==d&&a&&(a((0,t.Dw)(d)),i?.()),{limitReached:s,oldCount:o,newCount:d}}},163691:function(e,n,o){o.d(n,{Z:()=>a});let a=function(e){return{...e,ts:Date.now()}}},238957:function(e,n,o){o.d(n,{K7:()=>d,Vd:()=>u,WT:()=>s,iU:()=>r});var a=o(4533),t=o(994507),l=o(34550),i=o(163691);let s=18e5,d=t.dm,r=()=>{try{let{count:e,time:n,ts:o}=(0,l.M0)().getItem(a.SI)??{};if("number"==typeof e&&"number"==typeof n&&"number"==typeof o)return{count:e,time:n,ts:o};throw Error("Invalid revisitation data")}catch(e){return(0,t.dm)()}},u=e=>{(0,l.M0)().setItem(a.SI,(0,i.Z)(e))}},658375:function(e,n,o){o.d(n,{C:()=>i,P:()=>l});var a=o(173874),t=o(767415);let l=()=>!1,i=e=>{(0,a.LM)(e)&&!l()&&(0,t.nP)("mobile_signup_modal.rules.suppress_for_discover_article",{flushImmediate:!0,sampleRate:1})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/51723-5842c37b7792e64b.mjs.map